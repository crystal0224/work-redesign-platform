# 한국어 시간 표현 패턴 레퍼런스

## 📋 빠른 참조 가이드

이 문서는 `normalizeKoreanTime()` 함수가 인식하는 모든 한국어 시간 표현 패턴을 정리한 것입니다.

---

## ⏰ 시간 표현 패턴 (10가지)

### 1. "X시간 Y분" 패턴
**정규식**: `/(\d+)\s*시간\s*(\d+)\s*분/g`

**예시**:
- "1시간 30분" → 1.5시간
- "2시간 15분" → 2.25시간
- "0시간 45분" → 0.75시간

**변환 로직**: `hours + (minutes / 60)`

---

### 2. "X분" 패턴
**정규식**: `/(\d+)\s*분/g`

**예시**:
- "30분" → 0.5시간
- "45분" → 0.75시간
- "90분" → 1.5시간

**변환 로직**: `minutes / 60`

---

### 3. "X시간" 패턴
**정규식**: `/(\d+(?:\.\d+)?)\s*시간/g`

**예시**:
- "2시간" → 2시간
- "1.5시간" → 1.5시간
- "3시간" → 3시간

**변환 로직**: `parseFloat(hours)`

**참고**: 소수점 지원

---

### 4. "X시간 반" 패턴
**정규식**: `/(\d+)\s*시간\s*반/g`

**예시**:
- "1시간 반" → 1.5시간
- "2시간 반" → 2.5시간
- "3시간 반" → 3.5시간

**변환 로직**: `hours + 0.5`

---

### 5. "하루 X시간" 패턴
**정규식**: `/하루\s*(\d+(?:\.\d+)?)\s*시간/g`

**예시**:
- "하루 3시간" → 3시간
- "하루 2.5시간" → 2.5시간
- "하루 1시간" → 1시간

**변환 로직**: `parseFloat(hours)`

**참고**: 빈도는 자동으로 "Daily"로 추출됨

---

### 6. "일 X시간" 패턴
**정규식**: `/(?:^|[^하])일\s*(\d+(?:\.\d+)?)\s*시간/g`

**예시**:
- "일 3시간" → 3시간
- "일 2시간" → 2시간

**변환 로직**: `parseFloat(hours)`

**참고**: "하루"와 구분하기 위해 negative lookbehind 사용

---

### 7. "주 X시간" 패턴
**정규식**: `/주\s*(\d+(?:\.\d+)?)\s*시간(?!\s*씩)/g`

**예시**:
- "주 10시간" → 10시간
- "주 5시간" → 5시간

**변환 로직**: `parseFloat(hours)`

**참고**:
- "씩" 없는 경우만 매칭 (negative lookahead)
- 주 총 시간으로 해석

---

### 8. "월 X시간" 패턴
**정규식**: `/월\s*(\d+(?:\.\d+)?)\s*시간/g`

**예시**:
- "월 20시간" → 20시간
- "월 10시간" → 10시간

**변환 로직**: `parseFloat(hours)`

**참고**: 월 총 시간으로 해석

---

### 9. "주 X회, 각 Y시간" 패턴
**정규식**: `/주\s*(\d+)\s*회[,\s]*각\s*(\d+(?:\.\d+)?)\s*시간/g`

**예시**:
- "주 2회, 각 1시간" → 1시간
- "주 3회, 각 2시간" → 2시간
- "주 2회,각 1.5시간" → 1.5시간

**변환 로직**: `parseFloat(hoursPerSession)`

**참고**:
- 1회당 시간만 추출
- 쉼표 선택적
- 빈도는 자동으로 "Weekly"로 추출됨

---

### 10. "주 X회, Y시간씩" 패턴
**정규식**: `/주\s*(\d+)\s*회[,\s]*(\d+(?:\.\d+)?)\s*시간\s*씩/g`

**예시**:
- "주 2회, 1시간씩" → 1시간
- "주 3회,2시간씩" → 2시간

**변환 로직**: `parseFloat(hoursPerSession)`

**참고**: 패턴 9와 유사하지만 "씩" 키워드 사용

---

## 📅 빈도 표현 패턴 (6가지)

### 1. Daily (일일)
**정규식**: `/매일|일일|하루|매\s*일/g`

**매칭 예시**:
- "매일"
- "일일"
- "하루"
- "매 일" (공백 포함)

**출력**: `"Daily"`

---

### 2. Weekly (주간)
**정규식**: `/주간|주\s*\d+\s*회|매\s*주|주별|주단위/g`

**매칭 예시**:
- "주간"
- "주 2회"
- "매주"
- "주별"
- "주단위"

**출력**: `"Weekly"`

---

### 3. Monthly (월간)
**정규식**: `/월간|월\s*\d+\s*회|매\s*월|월별|월단위/g`

**매칭 예시**:
- "월간"
- "월 1회"
- "매월"
- "월별"
- "월단위"

**출력**: `"Monthly"`

---

### 4. Quarterly (분기)
**정규식**: `/분기|분기별|분기\s*\d+\s*회/g`

**매칭 예시**:
- "분기"
- "분기별"
- "분기 1회"

**출력**: `"Quarterly"`

---

### 5. Yearly (연간)
**정규식**: `/연간|연\s*\d+\s*회|매\s*년|연별|연단위/g`

**매칭 예시**:
- "연간"
- "연 2회"
- "매년"
- "연별"
- "연단위"

**출력**: `"Yearly"`

---

### 6. Ad-hoc (비정기)
**정규식**: `/필요시|비정기|수시|가끔/g`

**매칭 예시**:
- "필요시"
- "비정기"
- "수시"
- "가끔"

**출력**: `"Ad-hoc"`

---

## 🔍 복합 예시

### 예시 1: 시간 + 빈도 동시 추출
**입력**: "고객 VOC 분석은 주 2회, 각 1시간씩 수행합니다."

**추출 결과**:
```javascript
{
  timeSpent: 1,
  frequency: "Weekly",
  rawMatches: ["주 2회, 각 1시간", "주 2회"]
}
```

**분석**:
- "주 2회, 각 1시간" → 패턴 9 매칭 → 1시간
- "주 2회" → Weekly 빈도 매칭

---

### 예시 2: 복합 시간 표현
**입력**: "매일 고객 문의 처리에 1시간 30분이 소요됩니다."

**추출 결과**:
```javascript
{
  timeSpent: 1.5,
  frequency: "Daily",
  rawMatches: ["1시간 30분", "매일"]
}
```

**분석**:
- "1시간 30분" → 패턴 1 매칭 → 1 + 0.5 = 1.5시간
- "매일" → Daily 빈도 매칭

---

### 예시 3: 시간만 추출 (빈도 없음)
**입력**: "데이터 분석에 주 10시간을 투입합니다."

**추출 결과**:
```javascript
{
  timeSpent: 10,
  frequency: null,
  rawMatches: ["주 10시간"]
}
```

**분석**:
- "주 10시간" → 패턴 7 매칭 → 10시간
- 빈도 키워드 없음

---

## ⚙️ 알고리즘 동작 방식

### 1. 패턴 매칭 순서
모든 시간 패턴을 순회하며 매칭을 시도합니다.
구체적인 패턴(예: "주 X회, 각 Y시간")이 일반적인 패턴(예: "X시간")보다 먼저 정의되어 있어 우선 매칭됩니다.

### 2. 최댓값 선택
여러 시간 표현이 발견된 경우, **가장 큰 값**을 선택합니다.

**예시**:
- 입력: "1시간 30분 소요" → "1시간"(1), "30분"(0.5), "1시간 30분"(1.5) 모두 매칭
- 결과: 1.5시간 (최댓값)

### 3. 빈도는 첫 번째 매칭
빈도 표현은 **첫 번째로 매칭된 값**만 사용합니다.

**예시**:
- 입력: "매일 주간 보고서 작성" → "매일", "주간" 모두 매칭
- 결과: "Daily" (먼저 매칭된 것)

### 4. 중복 제거
`rawMatches`에는 중복이 제거된 원본 표현이 저장됩니다.

---

## 🧪 테스트 방법

### 테스트 스크립트 실행
```bash
node test-time-normalization.js
```

### 직접 테스트
```javascript
const result = normalizeKoreanTime("주 2회, 각 1시간 30분씩 수행합니다.");
console.log(result);
// { timeSpent: 1.5, frequency: "Weekly", rawMatches: [...] }
```

---

## 📊 정확도 통계

**테스트 케이스**: 10개
**통과율**: 100%

| 패턴 유형 | 테스트 수 | 통과 | 실패 |
|-----------|-----------|------|------|
| 복합 시간 표현 | 3 | 3 | 0 |
| 단순 시간 표현 | 4 | 4 | 0 |
| 빈도 표현 | 2 | 2 | 0 |
| 정보 없음 | 1 | 1 | 0 |

---

## 🔧 패턴 추가 방법

새로운 시간 표현 패턴을 추가하려면:

1. `workshop-server.js`의 `timePatterns` 배열에 추가:
```javascript
{
  regex: /새로운\s*패턴\s*(\d+)/g,
  handler: (match) => parseFloat(match[1])
}
```

2. `test-time-normalization.js`에 테스트 케이스 추가:
```javascript
{
  name: '테스트 X: 새 패턴',
  input: '새로운 패턴 표현',
  expected: { timeSpent: 예상값, frequency: null }
}
```

3. 테스트 실행하여 검증
```bash
node test-time-normalization.js
```

---

## 📌 주의사항

### 1. 정규식 순서 중요
- 구체적인 패턴을 먼저 배치
- 일반적인 패턴은 마지막에 배치
- 예: "주 X회, 각 Y시간"을 "X시간"보다 먼저

### 2. Negative Lookahead/Lookbehind 활용
- 불필요한 매칭 방지
- 예: "주 X시간(?!\s*씩)" → "씩" 없는 경우만

### 3. 소수점 지원
- `\d+` → 정수만
- `\d+(?:\.\d+)?` → 소수점 포함

### 4. 공백 처리
- `\s*` → 0개 이상 공백
- `\s+` → 1개 이상 공백
- 사용자 입력의 공백 변동성 고려

---

**버전**: 1.0.0
**최종 업데이트**: 2025-11-18
